<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="paper-search-icons.html">
<link rel="import" href="paper-search-input.html">
<link rel="import" href="../iron-a11y-keys/iron-a11y-keys.html">

<!--
An search bar a la material design.

Example:

    <paper-search-bar></paper-search-bar>

@group App Elements
@element paper-search-bar
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="paper-search-bar">
  <template>
    <style>
    :host {
      display: block;
      width: 100%;
      box-sizing: border-box;
      background: var(--paper-search-bar-background);
      @apply(--paper-search-bar);
    }
    :host, .input-wrapper {
      @apply(--layout-horizontal);
      @apply(--layout-center);
    }
    iron-icon {
      padding: 8px;
      width: 40px;
      height: 40px;
      box-sizing: border-box;
    }
    </style>
    <iron-icon icon="ps-icons:search"></iron-icon>
    <div class="input-wrapper">
      <paper-search-input value="{{value}}" placeholder="[[placeholder]]"></paper-search-input>
      <span class="flex"></span>
      <template is="dom-if" if="[[!_computeCustomCancel(customCancel)]]">
        <paper-icon-button icon="ps-icons:close" on-tap="cancel"></paper-icon-button>
      </template>
      <template is="dom-if" if="[[_computeCustomCancel(customCancel)]]">
        <content></content>
      </template>
    </div>

    <iron-a11y-keys id="a11y" target="[[target]]" keys="enter" on-keys-pressed="onEnter"></iron-a11y-keys>
    <iframe id="remember" name="remember" hidden src="about:blank"></iframe>
    <form target="remember" method="post" action="about:blank" hidden>
      <fieldset>
        <input id="search" value="[[value]]">
      </fieldset>
      <button type="submit" hidden></button>
    </form>
  </template>
  <script>
    Polymer({
      is: 'paper-search-bar',

      properties: {

      /**
       * The search value
       */
       value: {
         type: String,
         notify: true
       },

       placeholder: {
         type: String,
         value: 'Type here to search'
       },

        /**
         * Set to true for adding a cancel button and method yourself
         */
        customCancel: {
          type: Boolean,
          value: false
        },

        target: {
          type: Object,
          value: function() {
            return this;
          }
        }
      },

      cancel: function() {
        this.value = null;
      },

      _computeCustomCancel: function(a) {
        if (a) {
          return true;
        }
        return false;
      },

      onEnter: function() {
        this.querySelector('button').click();
      }

    });
  </script>
</dom-module>
